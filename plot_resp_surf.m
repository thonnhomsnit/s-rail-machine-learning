data = datatable81;

[j,k]=meshgrid(0:0.02:1,1:0.02:1);
[u,v]=meshgrid(0:0.02:1,1:0.02:1);
x1 = j;           %TR
x2 = u;            %A
x3 = 0.5*ones(51);      %T
x4 = 0.5*ones(51);      %L

responsesurf1 = ( ...
    +b(1).*x1 ...  
    +b(2).*x2 ...
    +b(3).*x3 ...
    +b(4).*x4 ...
    +b(5).*x1.*x1 ...
    +b(6).*x2.*x2 ...
    +b(7).*x3.*x3 ...
    +b(8).*x4.*x4 ...
    +b(9).*x1.*x2 ...
    +b(10).*x1.*x3 ...
    +b(11).*x1.*x4 ...
    +b(12).*x2.*x3 ...
    +b(13).*x2.*x4 ...
    +b(14).*x3.*x4 ...
    +b(15) ...
    );

rsm = ((responsesurf1)*(163.2074-37.11))+37.11;

[u,v]=meshgrid(1:0.02:2,120:0.8:160);
mesh(u,v,rsm,'FaceAlpha',0.2,'EdgeColor','k','FaceColor','b','EdgeAlpha',1);
grid on;
box on;
ax = gca;
ax.GridLineStyle = ':';
ax.GridAlpha = 0.4;
ax.TickDir = 'in';
set(gca, 'FontName', 'Times New Roman','FontSize',14,'FontSmoothing', ...
    'on','LineWidth',1.5,'TickLength',[0.025 0.025])
xlabel('\itTR\rm');
ylabel('\itA\rm (mm)')
zlabel('IPF (kN)')
zlim([50 200])
view(60,15)
hold on;

plot3(data(5:9:78,1),data(5:9:78,2),data(5:9:78,5),'kp','MarkerSize',10,'MarkerFaceColor',"g");
hold on;

